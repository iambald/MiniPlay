<html ng-app='app'>
<head>
  <link rel="stylesheet" href="styles/fonts.css" >
  <link rel="stylesheet" href="styles/material.red-blue.min.css" />
  <link rel='stylesheet' href='styles/popup.css'>

  <script src='scripts/vendor/jquery.js'></script>
  <script src='scripts/vendor/angular.min.js'></script>
  <script src='scripts/vendor/lodash.js'></script>

  <script src='scripts/enums.js'></script>
  <script src='scripts/popup/popup.js'></script>
  <script src='scripts/popup/controllers.js'></script>
  <script src='scripts/popup/controllers/footerController.js'></script>
  <script src='scripts/popup/directives.js'></script>
  <script src='scripts/popup/services/npService.js'></script>
  <script src='scripts/popup/services/InputManager.js'></script>
</head>
<body ng-controller='PopupController' ng-mouseup='InputManager.set("slider_dragging", false)' ng-keyup='handle_key($event)'>

  <div id='popup' class='mdl-layout mdl-layout--fixed-header'>
    <header class='mdl-layout__header'>
      <div class="mdl-layout__drawer-button" ng-click="menu_icon_click()" ng-if='np.status.protocol == "gmusic"'><i class="material-icons">{{menu_icon()}}</i></div>
      <i class='material-icons close-button' ng-click='clear_stack()' ng-show='data.view_stack.length > 0'>close</i>
      <section id='song-info' class='mdl-layout-title' ng-style='{"padding-left": np.status.protocol == "gmusic" ? 60 : 20}'>
        <div id='title' ng-style='{"text-transform": InputManager.get("displayed_content") == "" || InputManager.get("displayed_content") == "current_playlist" ? "none" : "capitalize", width: np.status.protocol == "gmusic" ? 220 : 260}'>{{data.title || np.status.title}}</div>
        <div id='subtitle' ng-switch='InputManager.get("displayed_content") == "" || InputManager.get("displayed_content") == "current_playlist"' ng-style='{width: np.status.protocol == "gmusic" ? 220 : 260}'>
          <div ng-switch-when='true' ng-hide='np.state != StateEnum.PLAYING'><a href='#' ng-click='dataClick("artist", {id: np.status.artist_id})'>{{np.status.artist}}</a> <span ng-hide='np.status.album.length == 0'>-</span> <a href='#' ng-click='dataClick("album", {id: np.status.album_id})'>{{np.status.album}}</a></div>
          <div ng-switch-when='false'>{{data.subtitle}}</div>
        </div>
      </section>
    </header>
    <div class="mdl-layout__drawer" ng-class='{"is-visible": InputManager.get("drawer_open")}'>
      <span class="mdl-layout-title">MiniPlay</span>
      <nav class="mdl-navigation">
        <div class='search-container'>
          <i class="material-icons">search</i>
          <form class='search' ng-submit='search()'>
            <div class="mdl-textfield mdl-js-textfield">
              <input class="mdl-textfield__input" autocomplete="off" ng-model='data.query' type="text" id="search" focus-me='InputManager.get("drawer_open")' tabindex="-1" >
              <label class="mdl-textfield__label" for="search">Search in library...</label>
            </div>
          </form>
        </div>
        <a class="mdl-navigation__link" href="" ng-click='drawer_click("Recent")'><i class='material-icons'>replay</i>Recent</a>
        <a class="mdl-navigation__link" href="" ng-click='drawer_click("Playlists")'><i class='material-icons'>playlist_play</i>Playlists</a>
        <a class="mdl-navigation__link" href="" ng-click='drawer_click("Stations")'><i class='material-icons'>radio</i>Stations</a>
        <a class="mdl-navigation__link" href="" ng-click='drawer_click("Artists")'><i class='material-icons'>person</i>Artists</a>
        <a class="mdl-navigation__link" href="" ng-click='drawer_click("Albums")'><i class='material-icons'>album</i>Albums</a>
        <a class="mdl-navigation__link" href="" ng-click='settings_click($event)'><i class='material-icons'>settings</i>Settings</a>
      </nav>
    </div>
    <section class='album-art' ng-style='{"background-image":album_art_background(), "display": should_show_art() ? "block" : "none"}' ng-click='album_art_click()'>
      <div id='art-controls'>
        <i mp-control id='repeat' class='material-icons' ng-class='{"art-control-active": np.status.repeat != RepeatEnum.NONE}' ng-disabled='np.state != StateEnum.PLAYING || np.status.disabled.repeat' title='Repeat songs'>{{repeat_icon()}}</i>
        <i mp-control id='shuffle' class='material-icons' ng-class='{"art-control-active": np.status.shuffle == true}' ng-disabled='np.state != StateEnum.PLAYING || np.status.disabled.shuffle' title='Shuffle songs' ng-click='np.status.shuffle=!np.status.shuffle'>shuffle</i>
      </div>
    </section>
    <section id='list-content' ng-switch='InputManager.get("displayed_content")' infinite-scroll='scroll_data(InputManager.get("displayed_content"))' infinite-scroll-disabled='should_disable_scroll()' infinite-scroll-distance='5'>
      <div ng-switch-when='playlist'>
        <div id='playlist' ng-include src='"templates/playlist.html"'></div>
      </div>
      <div ng-switch-when='current_playlist'>
        <div id='current_playlist' ng-include src='"templates/current_playlist.html"'></div>
      </div>
      <div ng-switch-when='playlists'>
        <div id='playlists' ng-include src='"templates/playlists.html"'></div>
      </div>
      <div ng-switch-when='loading'>
        <div id='loading' ng-include src='"templates/loading.html"'></div>
      </div>
      <div ng-switch-when='recent'>
        <div id='recents' ng-include src='"templates/recents.html"'></div>
      </div>
      <div ng-switch-when='stations'>
        <div id='stations' ng-include src='"templates/stations.html"'></div>
      </div>
      <div ng-switch-when='artists'>
        <div id='artists' ng-include src='"templates/artists.html"'></div>
      </div>
      <div ng-switch-when='artist'>
        <div id='artist' ng-include src='"templates/artist.html"'></div>
      </div>
      <div ng-switch-when='albums'>
        <div id='albums' ng-include src='"templates/albums.html"'></div>
      </div>
      <div ng-switch-when='options'>
        <div id='options' ng-include src='"templates/options.html"'></div>
      </div>
      <div ng-switch-when='search'>
        <div id='search' ng-include src='"templates/search.html"'></div>
      </div>
      <div id='list-none' ng-switch-default></div>
    </section>

    <footer id='controls'>
      <p id='slider-wrapper'>
        <input class='mp-slider mdl-slider mdl-js-slider' type='range' min='0' max='{{np.status.total_time_s}}' value='{{np.status.current_time_s}}' ng-mousedown='InputManager.set("slider_dragging", true)' tabindex="-1" />
      </p>
      <div id='current-time' ng-show='np.state == StateEnum.PLAYING'>{{np.status.current_time}}</div>
      <div id='total-time' ng-show='np.state == StateEnum.PLAYING'>{{np.status.total_time}}</div>
      <div id='controls-left' ng-include src='"templates/controls-left.html"'></div>
      <div id='controls-right' ng-include src='"templates/controls-right.html"'></div>
    </footer>

    <div class='mdl-layout__obfuscator' ng-click='InputManager.set("drawer_open", false)' ng-class='{"is-visible": InputManager.get("drawer_open")}'></div>
  </div>

  <script src="scripts/vendor/material.min.js"></script>
</body>
</html>
