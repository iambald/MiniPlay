<html ng-app='app'>
<head>
  <link rel="stylesheet" href="styles/fonts.css" >
  <link rel="stylesheet" href="styles/material.deep_orange-indigo.min.css" />
  <link rel='stylesheet' href='styles/popup.css'>

  <script src='scripts/angular.min.js'></script>
  <script src='scripts/jquery.js'></script>
  <script src='scripts/enums.js'></script>
  <script src='scripts/popup.js'></script>
  <script src='scripts/controllers.js'></script>
  <script src='scripts/directives.js'></script>
</head>
<body ng-controller='PopupController' ng-keypress='handle_key($event)' ng-mouseup='music_status.slider_dragging = false'>

  <div id='popup' >
    <div class='album-art' ng-style='{"background-image":album_art_background(), "display": music_status.playlist_pressed ? "none" : "block"}' ng-click='album_art_click()'>
      <div id='song-info' ng-class='{"blur-background": music_status.state == StateEnum.PLAYING}'>
        <div id='title'>{{music_status.title}}</div>
        <div id='artist'>{{music_status.artist}}</div>
        <div id='album'>{{music_status.album}}</div>
      </div>
      <ul id='top-controls'>
        <li mp-control id='shuffle' ng-class='{"top-control-active": music_status.shuffle == true}' ng-disabled='music_status.state != StateEnum.PLAYING || music_status.disabled.shuffle' title='Shuffle songs' ng-click='music_status.shuffle=!music_status.shuffle'>
          <i class="material-icons">shuffle</i>
        </li>
        <li mp-control id='repeat' ng-class='{"top-control-active": music_status.repeat != RepeatEnum.NONE}' ng-disabled='music_status.state != StateEnum.PLAYING || music_status.disabled.repeat' title='Repeat songs'>
          <i class="material-icons">{{repeat_icon()}}</i>
        </li>
        <li class='settings' ng-disabled='music_status.state != StateEnum.PLAYING' title='Settings' ng-click='settings_click($event)'>
          <i class='material-icons'>settings</i>
        </li>
      </ul>
        <div id='current-time' ng-disabled='music_status.state != StateEnum.PLAYING'>{{music_status.current_time}}</div>
        <div id='total-time' ng-disabled='music_status.state != StateEnum.PLAYING'>{{music_status.total_time}}</div>
    </div>
    <div id='playlist' ng-style='{"display" : music_status.playlist_pressed ? "flex" : "none"}'>
      <table class='mdl-data-table mdl-js-data-table' id='playlist-table'>
        <thead>
          <tr>
            <th id='song_header' class='mdl-data-table__cell--non-numeric'>Song</th>
            <th>
              <i id='schedule_icon' class="material-icons">schedule</i>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr class='song-row' ng-repeat='song in playlist' ng-click='playlist_click(song.index)' mp-scroll-if='music_status.playlist_pressed && song.currently_playing'>
            <td class='song-details-span mdl-data-table__cell--non-numeric'>
              <span class='song-info'>
                <img class='small-art' ng-src='{{song.album_art}}' ng-style='{opacity: song.currently_playing ? 0 : 100}'/>
                <div class='song-details'>
                  <div class='song-title'>{{song.title}}</div>
                  <div class='song-artist-album'>{{song.artist}} - {{song.album}}</div>
                </div>
                <div class='song-indicator' ng-class='{"song-indicator-active" : song.currently_playing && music_status.status == StatusEnum.PLAYING}' ng-disabled='!song.currently_playing'></div>
              </span>
            </td>
            <td class='duration'>
              <span>{{song.total_time}}</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <p id='slider-wrapper'>
      <input class='mp-slider mdl-slider mdl-js-slider' type='range' min='0' max='{{music_status.total_time_s}}' value='{{music_status.current_time_s}}' ng-mousedown='music_status.slider_dragging = true' />
    </p>
    <div id='controls'>
      <div id='controls-left'>
        <button mp-control id='rew' class='mdl-button mdl-js-button mdl-button--icon' ng-disabled='music_status.state != StateEnum.PLAYING || music_status.disabled.rew' title='Previous song'>
          <i class="material-icons">skip_previous</i>
        </button>
        <button mp-control id='play' class='mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab mdl-button--primary' ng-disabled='music_status.state != StateEnum.PLAYING || music_status.disabled.play' ng-attr-title='{{status_title()}}' ng-click='music_status.status=!music_status.status'>
          <i class="material-icons">{{status_icon()}}</i>
        </button>
        <button mp-control id='ff' class='mdl-button mdl-js-button mdl-button--icon' ng-disabled='music_status.state != StateEnum.PLAYING || music_status.disabled.ff' title='Next song'>
          <i class="material-icons">skip_next</i>
        </button>
      </div>
      <div id='controls-right'>
        <button mp-control id='up' class='mdl-button mdl-js-button mdl-button--icon thumb' ng-class='{"mdl-button--colored": music_status.thumb == ThumbEnum.UP}' ng-disabled='music_status.state != StateEnum.PLAYING || music_status.disabled.up' title='Thumbs up' ng-style='{"display": music_status.vol_pressed ? "none" : "block"}' ng-click='music_status.thumb = music_status.thumb == ThumbEnum.UP ? ThumbEnum.NONE : ThumbEnum.UP'>
          <i class="material-icons">thumb_up</i>
        </button>
        <button mp-control id='down' class='mdl-button mdl-js-button mdl-button--icon thumb' ng-class='{"mdl-button--colored": music_status.thumb == ThumbEnum.DOWN}' ng-disabled='music_status.state != StateEnum.PLAYING || music_status.disabled.down' title='Thumbs down' ng-style='{"display": music_status.vol_pressed ? "none" : "block"}' ng-click='music_status.thumb = music_status.thumb == ThumbEnum.DOWN ? ThumbEnum.NONE : ThumbEnum.DOWN'>
          <i class="material-icons">thumb_down</i>
        </button>
        <button id='vol' class='mdl-button mdl-js-button mdl-button--icon' ng-disabled='music_status.state != StateEnum.PLAYING || music_status.disabled.vslider' title='Volume' ng-click='music_status.vol_pressed=!music_status.vol_pressed'>
          <i class='material-icons'>{{volume_icon()}}</i>
        </button>
        <p id='vol-wrapper' ng-style='{"display": music_status.vol_pressed ? "block" : "none"}'>
          <input class='mp-volslider mdl-slider mdl-js-slider' type='range' min='0' max='100' value='{{music_status.volume}}' />
        </p>
        <button id='vol-up' class='mdl-button mdl-js-button mdl-button--icon' ng-disabled='music_status.state != StateEnum.PLAYING || music_status.disabled.vol' title='Volume' ng-click='music_status.vol_pressed=!music_status.vol_pressed' ng-style='{"display": music_status.vol_pressed ? "block" : "none"}'>
          <i class='material-icons'>volume_up</i>
        </button>
        <button mp-control id='playlist-button' class='mdl-button mdl-js-button mdl-button--icon' ng-disabled='music_status.state != StateEnum.PLAYING || music_status.disabled.playlist' title='Playlist' ng-click='music_status.playlist_pressed=!music_status.playlist_pressed' ng-style='{"display": music_status.vol_pressed ? "none" : "block"}'>
          <i class='material-icons'>queue_music</i>
        </button>
      </div>
    </div>
  </div>

  <script src="scripts/material.min.js"></script>
</body>
</html>
